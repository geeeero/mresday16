\documentclass{beamer}

% opacity bugfix: see http://tug.org/pipermail/pdftex/2007-December/007480.html
\pdfpageattr {/Group << /S /Transparency /I true /CS /DeviceRGB>>}

\usepackage[utf8]{inputenc}
\usepackage[OT1]{fontenc}

\usepackage{tikz}
\usetikzlibrary{%
   arrows,%
   calc,%
   fit,%
   patterns,%
   plotmarks,%
   shapes.geometric,%
   shapes.misc,%
   shapes.symbols,%
   shapes.arrows,%
   shapes.callouts,%
   shapes.multipart,%
   shapes.gates.logic.US,%
   shapes.gates.logic.IEC,%
   er,%
   automata,%
   backgrounds,%
   chains,%
   topaths,%
   trees,%
   petri,%
   mindmap,%
   matrix,%
   calendar,%
   folding,%
   fadings,%
   through,%
   patterns,%
   positioning,%
   scopes,%
   decorations.fractals,%
   decorations.shapes,%
   decorations.text,%
   decorations.pathmorphing,%
   decorations.pathreplacing,%
   decorations.footprints,%
   decorations.markings,%
   shadows}
\usepackage{animate}
\usepackage{amssymb, amsmath, amsfonts, enumerate}
%\usepackage{bbold}
\newcommand\hmmax{0}
\usepackage{bm}
%\usepackage{dsfont}
\usepackage{pxfonts}
\usepackage{xcolor}
\usepackage{url}

\usepackage[backend=bibtex,style=authoryear,dashed=false]{biblatex}
\addbibresource{refs.bib}
%\renewcommand{\bibfont}{\normalfont\scriptsize}
\setlength{\bibhang}{3ex}

\usepackage{hyperref}

\usetheme[official=false,department=none]{tue2008}
%\usefonttheme{default}


%\usetheme[secheader]{Boadilla}
%\setbeamercovered{transparent}
%\setbeamercovered{invisible}
%\setbeamertemplate{navigation symbols}{}
%\setbeamertemplate{bibliography item}[text] % numbered references
%\useoutertheme{infolines}
%\setbeamertemplate{headline}{}
%\setbeamertemplate{footline}{\hspace*{5mm}\hfill\insertframenumber\hspace*{5mm}\vspace{3mm}}
%\setbeamercolor{alerted text}{fg=orange!80!black}

% ------------------------------------------------------------------------------

\newcommand{\vcenterbox}[1]{\ensuremath{\vcenter{\hbox{#1}}}}
%
\newcommand{\reals}{\mathbb{R}}
\newcommand{\posreals}{\reals_{>0}}
\newcommand{\posrealszero}{\reals_{\ge 0}}
\newcommand{\naturals}{\mathbb{N}}

\newcommand{\dd}{\,\mathrm{d}}

\newcommand{\mbf}[1]{\mathbf{#1}}
\newcommand{\bs}[1]{\boldsymbol{#1}}
\renewcommand{\vec}[1]{{\bm#1}}

\newcommand{\uz}{^{(0)}} % upper zero
\newcommand{\un}{^{(n)}} % upper n
\newcommand{\ui}{^{(i)}} % upper i
\newcommand{\uell}{^{(\ell)}} % upper ell

\newcommand{\ul}[1]{\underline{#1}}
\newcommand{\ol}[1]{\overline{#1}}

\newcommand{\Rsys}{R_\text{sys}}
\newcommand{\lRsys}{\ul{R}_\text{sys}}
\newcommand{\uRsys}{\ol{R}_\text{sys}}

\newcommand{\Fsys}{F_\text{sys}}
\newcommand{\lFsys}{\ul{F}_\text{sys}}
\newcommand{\uFsys}{\ol{F}_\text{sys}}

\def\Tsys{T_\text{sys}}

\def\tmax{t_\text{max}}
\def\tnow{t_\text{now}}
\def\tpnow{t^+_\text{now}}

\newcommand{\ptk}{p^k_t}

\newcommand{\E}{\operatorname{E}}
\newcommand{\V}{\operatorname{Var}}
\newcommand{\sd}{\operatorname{sd}}

\newcommand{\wei}{\operatorname{Wei}} % Weibull Distribution
\newcommand{\ig}{\operatorname{IG}}   % Inverse Gamma Distribution
\newcommand{\ber}{\operatorname{Bernoulli}} 
\newcommand{\bin}{\operatorname{Binomial}}
\newcommand{\be}{\operatorname{Beta}} 
\newcommand{\bebin}{\operatorname{Beta-binomial}}
\newcommand{\norm}{\operatorname{N}}

\def\then{{\structure{$\rule[0.35ex]{2ex}{0.5ex}\!\!\!\blacktriangleright$}}}
\def\play{{\structure{$\blacktriangleright$}}}
\def\gplus{{\structure{\rule[0.45ex]{1.4ex}{0.4ex}\hspace{-0.9ex}\rule[0.0ex]{0.4ex}{1.3ex}\hspace{0.5ex}}}}
\def\gminus{{\structure{\rule[0.45ex]{1.4ex}{0.4ex}}}}

\input{nydefs.tex}
\input{nycoldefs.tex}

%%\def\blau#1{{\color{lmugreen2}#1}}
%\def\rot#1{{\color{red}#1}}
%\def\gruen#1{{\color{blue}#1}}

\newcommand{\x}{\vec{x}}

\def\tnow{t_\text{now}}
\def\tpnow{t^+_\text{now}}

\newcommand{\comp}[1]{\raisebox{-1mm}{\tikz{\node[%type1
rectangle,rounded corners=0mm,draw,fill=tuepmsgreen!70,thick,inner sep=0pt,minimum size=4mm]{#1};}}}

\newcommand{\cyansec}[1]{\textcolor{tuecyan}{\large\bf #1}}
\newcommand{\cyanalert}[1]{\textcolor{tuecyan}{#1}}
\newcommand{\bluesec}[1]{\textcolor{tueblue}{\large\bf #1}}
\newcommand{\bluealert}[1]{\textcolor{tueblue}{#1}}

\setbeamertemplate{itemize item}{\tiny\raise1.5pt\hbox{\color{tueblue}$\blacktriangleright$}}

% ------------------------------------------------------------------------------


\title{Nonparametric System Reliability\\ Combining Expert Knowledge and Data}

\author{\ul{Gero Walter}\inst{1}, Louis Aslett\inst{2}, Frank Coolen\inst{3}}
\institute{ \inst{1} Eindhoven University of Technology, Eindhoven, NL\\ 
            \inst{2} University of Oxford, Oxford, UK\\
            \inst{3} Durham University, Durham, UK \\[2ex]
            \url{g.m.walter@tue.nl} \\[2ex]
            \includegraphics[height=9mm]{logos/tuelogo} \quad 
            \includegraphics[height=9mm]{logos/university_of_oxford} \quad
            \includegraphics[height=9mm]{logos/logounidurham-large} \quad
            \includegraphics[height=9mm]{logos/dinalog-hp} }
\date{2016-02-04}

\begin{document}

\frame{
\titlepage
}

\addtocounter{framenumber}{-1} 

\begin{frame}{System Reliability}

\begin{columns}
\begin{column}{0.3\textwidth}
\begin{tikzpicture}
[type1/.style={rectangle,draw,fill=tuepmsgreen!70,very thick,inner sep=0pt,minimum size=6mm},
 type2/.style={rectangle,draw,fill=tuepmsgreen!70,very thick,inner sep=0pt,minimum size=6mm},
 type3/.style={rectangle,draw,fill=tuepmsgreen!70,very thick,inner sep=0pt,minimum size=6mm},
 cross/.style={cross out,draw=red,very thick,minimum width=7mm, minimum height=5mm},
 hv path/.style={thick, to path={-| (\tikztotarget)}},
 vh path/.style={thick, to path={|- (\tikztotarget)}}]
\begin{scope}[scale=0.75]
\node[type1] (T1-2) at ( 1.2, 1.1) {1};
\node[type1] (T1-3) at ( 1.2,-1.1) {1};
\node[type1] (T1-5) at ( 2.8, 1.1) {1};
\node[type1] (T1-6) at ( 2.8,-1.1) {1};
\node[type2] (T2)   at ( 2.0, 0)   {2};
\node[type3] (T3)   at ( 4.3, 0)   {3};
\coordinate (start) at (0  ,0);
\coordinate (end)   at (4.9,0);
\coordinate (bista) at (0.4,0);
\coordinate (biend) at (3.6,0);
\path (bista)     edge[hv path] (start)
                  edge[vh path] (T1-2.west)
                  edge[vh path] (T1-3.west)
      (T1-2.east) edge[hv path] (T2.north)
      (T1-3.east) edge[hv path] (T2.south)
      (T2.north)  edge[vh path] (T1-5.west)
      (T2.south)  edge[vh path] (T1-6.west)
      (biend)     edge[vh path] (T1-5.east)
                  edge[vh path] (T1-6.east)
                  edge[hv path] (T3.west)
      (T3.east)   edge[hv path] (end);
\end{scope}
\end{tikzpicture}
\end{column}
\begin{column}{0.7\textwidth}
We want to learn about the system reliability $\Rsys(t) = P(\Tsys > t)$ based on
\begin{enumerate}
\item[\play]<2-> component test data:
 \begin{itemize}
 \item[] $n_k$ failure times for components of type $k$, $k = 1, \ldots, K$
 \end{itemize}
\item[\play]<3-> cautious assumptions\\ on component reliability:
 \begin{itemize}
 \item[] expert information,\\ e.g.\ from maintenance managers and staff
 \end{itemize}
\end{enumerate}
\end{column}
\end{columns}
\begin{center}
\uncover<4->{\cyanalert{How to combine these two information sources?}}
\end{center}
\end{frame}

\begin{frame}{Bayesian Inference}
\vspace*{-2ex}
\begin{align*}
\begin{array}{ccccl}
\uncover<1->{\text{expert info}        & + & \text{data}                & \to & \text{complete picture} \\[1.5ex]}
\uncover<2->{\text{prior distribution} & + & \text{sample distribution} & \to & \text{posterior distribution} \\[1.5ex]
 f(p) & \times & f(s \mid p) & \propto & f(p \mid s) \\
 & & & & \qquad\text{\bluealert{\play\ Bayes' Rule}} \\}
%\uncover<3->{\downarrow & & \downarrow & & \hspace*{3ex} \downarrow \\
\uncover<4->{\text{Beta prior}}   & & \uncover<3->{\text{Binomial}}         & & \uncover<5->{\text{Beta posterior}} \\
\uncover<4->{}                    & & \uncover<3->{\text{distribution}}     & & \uncover<5->{\qquad \text{\bluealert{\play\ conjugacy}}}\\[1ex]
\uncover<4->{p \sim \be(\az,\bz)} & & \uncover<3->{s \mid p \sim \bin(n,p)} & & \uncover<5->{p \mid s \sim \be(\an,\bn)}
\end{array}
\end{align*}
\vspace*{-3ex}
\begin{tikzpicture}
\uncover<6->{%
\node at (0,0) {\parbox{0.99\textwidth}{%
\begin{itemize}
\item conjugate prior makes learning about parameter tractable,\\  %posterior distribution
      just update hyperparameters:\quad $\az \to \an$, $\bz \to \bn$
\item closed form for some inferences: $\E[p\mid s] = \frac{\an}{\an+\bn}$
\end{itemize}}};}
\uncover<3-5>{%
\node at (-0.5,0) {\includegraphics[width=0.25\textwidth]{figs/smallfig-binom}};}
\uncover<4-5>{%
\node at (-4.5,0) {\includegraphics[width=0.25\textwidth]{figs/smallfig-prior}};}
\uncover<5>{%
\node at ( 3.5,0) {\includegraphics[width=0.25\textwidth]{figs/smallfig-posterior}};}
\end{tikzpicture}
\end{frame}

\begin{frame}{Nonparametric Component Reliability}
%nonparametric model for component failure time distribution\\
%example reliability curve on same frame?
\begin{tikzpicture}
\node at (1,3.5) %
{\parbox{\textwidth}{%
\uncover<1->{%
Functioning probability $\ptk$ of \comp{k} for each time $t \in {\cal T} = \{\dot{t}_1, \dot{t}_2, \ldots \}$\\
\quad\play\ discrete component reliability function $R^k(t) = p^k_t, \ t \in {\cal T}$.}}};
\uncover<2>{\node at (0,0) {\includegraphics[width=0.7\textwidth]{figs/discr-rel-0.pdf}};}
\uncover<3>{\node at (0,0) {\includegraphics[width=0.7\textwidth]{figs/discr-rel-1.pdf}};}
\uncover<4>{\node at (0,0) {\includegraphics[width=0.7\textwidth]{figs/discr-rel-3.pdf}};}
\uncover<5>{\node at (0,0) {\includegraphics[width=0.7\textwidth]{figs/discr-rel-bt1.pdf}};}
\node at (1,0) %
{\parbox{\textwidth}{%
\uncover<6->{%
Choosing $\ptk$'s directly is hard (also ignores uncertainty in choice)\\}
\uncover<7->{%
\then\ use Bayesian inference to estimate $\ptk$'s:} %combine information from
\begin{itemize}
\item[\play]<8-> failure times $\vec{t}^k = (t^k_1, \ldots, t^k_{n_k})$ from test data
 \begin{itemize}
 \item[] number of type $k$ components functioning at $t$:\\
 $S^k_t \sim \bin(\ptk, n_k)$
 \end{itemize}
\item[\play]<9-> expert knowledge
 \begin{itemize}
 \item[] Beta parameters for each $k$ and $t$:\\
 $\ptk \sim \be(\az_{k,t}, \bz_{k,t})$
 \end{itemize}
\item[\play]<10-> complete picture
 \begin{itemize}
 \item[] updated Beta parameters for each $k$ and $t$:\\
 $\ptk \mid s^k_t \sim \be(\an_{k,t}, \bn_{k,t})$
 \end{itemize}
\end{itemize}}};
\end{tikzpicture}

\end{frame}

\begin{frame}{System Reliability}

%(adapt slide 8 of ESREL talk)\\
%cite risk analysis paper\\
%frame with example graph?
\play\ Closed form for the system reliability via the survival signature:\\[-2ex]
\begin{tikzpicture} % l b r t
[cyanbox/.style={rounded corners, text centered, fill=tuecyan!20, inner sep=5mm},
 cyanrand/.style={rounded corners, text centered, draw=tuecyan!50, inner sep=2mm, very thick, font=\footnotesize},
 type1/.style={rectangle,draw,fill=tuepmsgreen!70,very thick,inner sep=0pt,minimum size=6mm},
 type2/.style={rectangle,draw,fill=tuepmsgreen!70,very thick,inner sep=0pt,minimum size=6mm},
 type3/.style={rectangle,draw,fill=tuepmsgreen!70,very thick,inner sep=0pt,minimum size=6mm},
 hv path/.style={thick, to path={-| (\tikztotarget)}},
 vh path/.style={thick, to path={|- (\tikztotarget)}},
 pfeil/.style={-latex', line width=1mm, color=tuered, shorten <=1mm}]
%\fill (0,0) circle (3pt);
%\uncover<1-2>{\node at (0,0) {\includegraphics[height=0.95\textheight]{../poster-system/poster-system}};}
\uncover<1->{\node at (0,0) %
     {\parbox{\textwidth}{\begin{multline*}
       P\left(\Tsys > t \mid \{\az_{k,t},\bz_{k,t},\vec{t}^k\}^{1:K}\right)\\
       = \sum_{l_1=0}^{m_1} \cdots \sum_{l_K=0}^{m_K} \Phi(l_1,\ldots,l_K)
         \prod_{k=1}^K P(C^k_t = l_k\mid\az_{k,t},\bz_{k,t},\vec{t}^k)\end{multline*}}};}
%\uncover<2-2>{\node at (-3,-3) {\includegraphics[width=0.5\textwidth,trim = 50 400 520 610, clip]{../poster-system/poster-system}};}
\uncover<2->{\node[cyanrand] (survsign) at (-3.1,-3.6)%
     {\parbox[c]{0.51\textwidth}{Survival signature $\Phi(l_1,\ldots,l_K)$\\ \parencite{2012:survsign}\\
       $= P(\text{system functions} \mid \{l_k \text{ \comp{k}'s function}\}^{1:K})$\\[1ex]
      \begin{tabular}{ccc|l}
      $l_1$ & $l_2$ & $l_3$ & $\Phi$ \\
      \hline
      0 & 0 & 1 & 0 \\
      1 & 0 & 1 & 0 \\
      2 & 0 & 1 & 1/3 \\
      3 & 0 & 1 & 1 \\
      4 & 0 & 1 & 1 %\rule[-2.2ex]{0ex}{1ex}%\phantom{\vdots}
      \end{tabular} \hspace{1ex}
      \begin{tabular}{ccc|l}
      $l_1$ & $l_2$ & $l_3$ & $\Phi$ \\
      \hline
      0 & 1 & 1 & 0 \\
      1 & 1 & 1 & 0 \\
      2 & 1 & 1 & 2/3 \\
      3 & 1 & 1 & 1 \\
      4 & 1 & 1 & 1 
%      \vdots & \vdots & \vdots & \vdots
      \end{tabular} } };
\draw [pfeil] (survsign.north) to [out=50,in=260] (0.3,-0.7);}
\uncover<3>{%
\begin{scope}[xshift=1cm,yshift=-3.5cm]
\begin{scope}[scale=0.75]
\node[type1] (T1-2) at ( 1.2, 1.1) {1};
\node[type1] (T1-3) at ( 1.2,-1.1) {1};
\node[type1] (T1-5) at ( 2.8, 1.1) {1};
\node[type1] (T1-6) at ( 2.8,-1.1) {1};
\node[type2] (T2)   at ( 2.0, 0)   {2};
\node[type3] (T3)   at ( 4.3, 0)   {3};
\coordinate (start) at (0  ,0);
\coordinate (end)   at (4.9,0);
\coordinate (bista) at (0.4,0);
\coordinate (biend) at (3.6,0);
\path (bista)     edge[hv path] (start)
                  edge[vh path] (T1-2.west)
                  edge[vh path] (T1-3.west)
      (T1-2.east) edge[hv path] (T2.north)
      (T1-3.east) edge[hv path] (T2.south)
      (T2.north)  edge[vh path] (T1-5.west)
      (T2.south)  edge[vh path] (T1-6.west)
      (biend)     edge[vh path] (T1-5.east)
                  edge[vh path] (T1-6.east)
                  edge[hv path] (T3.west)
      (T3.east)   edge[hv path] (end);
\end{scope}
\end{scope}}
\uncover<4>{\node[cyanrand] (postpred) at (3,-3.6)%
     {\parbox[c]{0.41\textwidth}{Posterior predictive probability that\\ in a new system, $l_k$ of the $m_k$ \comp{k}'s\\
                                function at time $t$:\\[1ex] \hspace*{1ex}
                                $\binom{m_k}{l_k} \int [P(T <   t \mid \ptk)]^{l_k}$ \\ \hspace*{5.6ex}
                                                        $[P(T \ge t \mid \ptk)]^{m_k-l_k}$ \\ \hspace*{6ex}
                                $f(\ptk \mid \az_{k,t},\bz_{k,t},\vec{t}^k)\, d\ptk $\\[1ex] \hspace*{5ex}
                                $= \binom{m_k}{l_k} \frac{B(      \az_{k,t} + s^k_t,             \bz_{k,t} + n_k - s^k_t)}%
                                                         {B(l_k + \az_{k,t} + s^k_t, m_k - l_k + \bz_{k,t} + n_k - s^k_t)}$}};
\draw [pfeil] (postpred.north) to [out=90,in=270] (3.0,-0.7);}
\end{tikzpicture}

\end{frame}

\begin{frame}{System Reliability Example}

***bridge system

\end{frame}

\begin{frame}{***pdc etc, 6 slides}

(adapt slides 3--6 of ESREL talk)\\
choosing all these Beta parameters is still hard\ldots\\
vague, incomplete prior info, pdc\\
reparametrization\\
Beta example\\
imprecision\\
sets of priors\\
sets of Betas example?

\end{frame}


\begin{frame}{***Rsys bounds}

(adapt slide 9 of ESREL talk)\\
mostly analytically (via theorems)

\end{frame}

\begin{frame}{***Rsys example}

bridge system or brake system example graph?\\
(change colours)

\end{frame}

\begin{frame}{***summary \& outlook}

(adapt slide 11 of ESREL talk)\\
case study\\
block policy with minimal repair?\\
(nonparam hazard rate $h^k(t_j) = (p^k_{t_j} - p^k_{t_{j+1}}) / p^k_{t_j}$)

\end{frame}

\begin{frame}{References}
%\begin{frame}[allowframebreaks]{References}
\printbibliography[heading=none]
\end{frame}

\end{document}
